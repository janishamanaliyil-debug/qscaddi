{% extends "chatapp/base.html" %}
{% load static %}
{% block extra_css %}
<link rel="stylesheet" href="{% static 'style/index.css' %}">
{% endblock %}

{% block body %}
<div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <!-- Home Icon -->
            <div class="sidebar-icon" data-tooltip="Home">
                <i class="bi bi-house"></i>
            </div>
            
            <!-- Project Icon with Submenu -->
            <div class="sidebar-icon has-submenu" data-tooltip="Project" id="projectIcon">
                <i class="bi bi-buildings"></i>
            </div>
            
            <!-- Template Upload Icon -->
            <div class="sidebar-icon" data-tooltip="Templates">
                <i class="bi bi-upload"></i>
            </div>
            
            <!-- Integrations Icon -->
            <div class="sidebar-icon" data-tooltip="Integrations">
                <i class="bi bi-link"></i>
            </div>
            
            <!-- Settings Icon -->
            <div class="sidebar-icon" data-tooltip="Settings">
                <i class="bi bi-gear"></i>
            </div>
            
            <!-- Rulers Icon -->
            <!-- <div class="sidebar-icon" data-tooltip="">
                <i class="bi bi-rulers"></i>
            </div> -->
            
            <div class="sidebar-bottom">
                <!-- User Avatar -->
                 <div class="sidebar-icon has-submenu" data-tooltip="Account" id="accountIcon">
                  <i class="bi bi-person"></i>
                </div>
            </div>
        </div>

        <!-- Project Main Menu (Year Selection) -->
        <div class="submenu-panel" id="projectMainmenu">
            <div class="submenu-header">Project</div>
            
            <!-- Year Folder -->
            <div class="submenu-item has-nested" id="folderByYear">
                <i class="bi bi-calendar"></i>
                <span>2026</span>
                <i class="bi bi-chevron-right submenu-arrow"></i>
            </div>
        </div>

        <!-- Year Submenu (Project List) -->
        <div class="submenu-panel nested-submenu" id="yearSubmenu">
            <div class="submenu-header-with-action">
                <span class="submenu-header-text">2026</span>
                <button class="add-project-btn" id="addProjectBtn" title="Add New Project">
                    <i class="bi bi-plus-lg"></i>
                </button>
            </div>
            
            <!-- Project 1 -->
            <div class="submenu-item has-nested" id="project1Item">
                <i class="bi bi-folder2"></i>
                <span>Project 1</span>
                <i class="bi bi-chevron-right submenu-arrow"></i>
            </div>
            
            <!-- Project 2 -->
            <div class="submenu-item has-nested" id="project2Item">
                <i class="bi bi-folder2"></i>
                <span>Project 2</span>
                <i class="bi bi-chevron-right submenu-arrow"></i>
            </div>
        </div>

        <!-- Project Submenu (Pre-Contract & Post-Contract) -->
        <div class="submenu-panel nested-submenu-level-2" id="projectSubmenu">
            <div class="submenu-header">Project</div>
            
            <!-- Pre-Contract -->
            <div class="submenu-item has-nested" id="preContractItem">
                <i class="bi bi-folder"></i>
                <span>Pre-Contract</span>
                <i class="bi bi-chevron-right submenu-arrow"></i>
            </div>
            
            <!-- Post-Contract -->
            <div class="submenu-item has-nested" id="postContractItem">
                <i class="bi bi-folder-check"></i>
                <span>Post-Contract</span>
                <i class="bi bi-chevron-right submenu-arrow"></i>
            </div>
        </div>

        <!-- Pre-Contract Nested Submenu -->
        <div class="submenu-panel nested-submenu-level-3" id="preContractSubmenu">
            <div class="submenu-header">Pre-Contract</div>
            <div class="submenu-item">
                <i class="bi bi-file-text"></i>
                <span>CD</span>
            </div>
            <div class="submenu-item">
                <i class="bi bi-file-text"></i>
                <span>SD</span>
            </div>
            <div class="submenu-item">
                <i class="bi bi-file-text"></i>
                <span>DD</span>
            </div>
            <div class="submenu-item">
                <i class="bi bi-file-text"></i>
                <span>IFC</span>
            </div>
            <div class="submenu-item">
                <i class="bi bi-clipboard-data"></i>
                <span>Tender Analysis</span>
            </div>
        </div>

        <!-- Post-Contract Nested Submenu -->
        <div class="submenu-panel nested-submenu-level-3" id="postContractSubmenu">
            <div class="submenu-header">Post-Contract</div>
            <div class="submenu-item">
                <i class="bi bi-file-earmark-bar-graph"></i>
                <span>IPC's</span>
            </div>
            <div class="submenu-item">
                <i class="bi bi-file-earmark-diff"></i>
                <span>VO's</span>
            </div>
            <div class="submenu-item">
                <i class="bi bi-calculator"></i>
                <span>Final Account</span>
            </div>
        </div>
      
        <!-- Account Submenu -->
        <div class="submenu-panel submenu-account" id="accountSubmenu">
            <div class="submenu-header">Account</div>

            <div class="submenu-item">
                <i class="bi bi-chat-dots"></i>
                <span>Feedback</span>
            </div>

            <div class="submenu-item">
                <i class="bi bi-person-badge"></i>
                <span>About Profile</span>
            </div>
 
            <div class="submenu-item">
                <i class="bi bi-box-arrow-right"></i>
                <span><a class="app-link" href="{% url 'chatapp:login' %}">Sign Out</a></span>
            </div>
        </div>


        <!-- Main Content -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="app-name">QS CoPilot</div>
            </div>

            <!-- Center Greeting -->
            <div class="center-greeting" id="centerGreeting">Where should we begin?</div>

            <!-- Chat Area -->
            <div class="chat-area" id="chatArea">
                <!-- Tender upload section will be dynamically created here -->
            </div>

            <!-- Input Area -->
            <div class="input-container">
                <form id="fileUploadForm" method="POST" enctype="multipart/form-data">
                    {% csrf_token %}
                    <div class="file-preview" id="filePreview"></div>
                    <div class="input-wrapper">
                        <input type="file" name="files" id="fileInput" style="display: none;" multiple>
                        <button type="button" class="file-input-btn" onclick="document.getElementById('fileInput').click()">
                            <i class="bi bi-plus-lg"></i>
                        </button>
                        <textarea 
                            class="message-input" 
                            id="messageInput" 
                            placeholder="Lets do our work together..."
                            rows="1"></textarea>
                        <button class="send-btn" id="sendBtn" type="submit">
                            <i class="bi bi-send-fill"></i>
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
{% endblock %}

{% block extra_js %}
<script>
    // Define the tender analysis URL from Django
    const TENDER_ANALYSIS_URL = "{% url 'chatapp:tender_analysis' %}";
</script>
<script src="{% static 'js/index.js' %}"></script>
{% endblock %}